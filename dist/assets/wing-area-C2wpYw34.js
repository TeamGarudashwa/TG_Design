import"./style-hLBxd820.js";import"./export-utils-B9yzkw5u.js";document.addEventListener("DOMContentLoaded",()=>{const g=document.querySelectorAll(".tab"),v=document.getElementById("calculate");document.getElementById("vstall-rows"),document.getElementById("clmax-rows");const I=document.getElementById("add-vstall"),F=document.getElementById("add-clmax"),E=document.querySelector(".results-section"),y=document.getElementById("results-container");function b(){const e=window.location.pathname.split("/").pop()||"index.html";g.forEach(t=>{const n=t.getAttribute("href");e==="index.html"&&n==="index.html"||n&&n===e?t.classList.add("active"):t.classList.remove("active")})}function k(){g.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.getAttribute("href");n&&(window.location.href=n)})})}function x(){const e={weight:document.getElementById("weight").value,vstallStart:document.getElementById("vstall-start").value,vstallEnd:document.getElementById("vstall-end").value,vstallStep:document.getElementById("vstall-step").value,clmaxStart:document.getElementById("clmax-start").value,clmaxEnd:document.getElementById("clmax-end").value,clmaxStep:document.getElementById("clmax-step").value};localStorage.setItem("wingAreaInputs",JSON.stringify(e))}function L(){const e=localStorage.getItem("wingAreaInputs");if(e){const t=JSON.parse(e);document.getElementById("weight").value=t.weight||"",document.getElementById("vstall-start").value=t.vstallStart||"10",document.getElementById("vstall-end").value=t.vstallEnd||"20",document.getElementById("vstall-step").value=t.vstallStep||"1",document.getElementById("clmax-start").value=t.clmaxStart||"1.0",document.getElementById("clmax-end").value=t.clmaxEnd||"2.0",document.getElementById("clmax-step").value=t.clmaxStep||"0.1"}}function C(){try{const e=parseFloat(document.getElementById("weight").value);if(isNaN(e)||e<=0){w("Please enter a valid aircraft weight (must be greater than 0)");return}const t=parseFloat(document.getElementById("vstall-start").value),n=parseFloat(document.getElementById("vstall-end").value),h=parseFloat(document.getElementById("vstall-step").value);if(isNaN(t)||isNaN(n)||isNaN(h)||t<0||n<=t||h<=0){w("Invalid Vstall range values. Please check your inputs.");return}const r=parseFloat(document.getElementById("clmax-start").value),o=parseFloat(document.getElementById("clmax-end").value),m=parseFloat(document.getElementById("clmax-step").value);if(isNaN(r)||isNaN(o)||isNaN(m)||r<=0||o<=r||m<=0){w("Invalid CLmax range values. Please check your inputs.");return}const l=[];for(let a=t;a<=n;a+=h)l.push(parseFloat(a.toFixed(2)));l[l.length-1]<n&&l.push(parseFloat(n.toFixed(2)));const i=[];for(let a=r;a<=o;a+=m)i.push(parseFloat(a.toFixed(2)));i[i.length-1]<o&&i.push(parseFloat(o.toFixed(2)));const u=[],c=1.225,d=9.81,s=[];s.push(["CLmax  Vstall",...l.map(a=>`${a} m/s`)]);for(const a of i){const f=[`${a}`];for(const p of l){const B=2*e*d/(c*Math.pow(p,2)*a);f.push(B.toFixed(2)+" m²")}s.push(f),u.push({clmax:a,vstalls:l.map((p,B)=>({vstall:p,wingArea:parseFloat((2*e*d/(c*Math.pow(p,2)*a)).toFixed(2))}))})}x(),S({results:u,vstalls:l,clmaxes:i,matrix:s})}catch(e){console.error("Error calculating wing area:",e),w("An error occurred during calculation. Please check your inputs and try again.")}}function S({results:e,vstalls:t,clmaxes:n,matrix:h}){if(!e||e.length===0){y.innerHTML='<p class="no-results">No results to display. Please check your inputs and try again.</p>';return}E.style.display="block",E.style.opacity="1",E.style.visibility="visible";const r=document.createElement("div");r.className="table-responsive";const o=document.createElement("table");o.className="results-table";const m=document.createElement("thead");let l=document.createElement("tr");l.innerHTML='<th class="corner-header">CLmax ↓<br>Vstall →</th>',t.forEach(c=>{l.innerHTML+=`<th>${c} m/s</th>`}),m.appendChild(l),o.appendChild(m);const i=document.createElement("tbody");n.forEach(c=>{const d=document.createElement("tr");d.innerHTML=`<th>${c}</th>`,t.forEach(s=>{const f=e.find(p=>p.clmax===c).vstalls.find(p=>p.vstall===s).wingArea.toFixed(4);d.innerHTML+=`
          <td class="copyable" data-value="${f}" title="Click to copy">
            <div class="cell-content">
              <span class="value">${f}</span>
              <span class="unit">m²</span>
            </div>
          </td>`}),i.appendChild(d)}),o.appendChild(i),r.appendChild(o);const u=document.createElement("button");u.className="export-btn",u.innerHTML='<i class="fas fa-download"></i> Export to Excel',u.onclick=()=>N(e,t,n),y.innerHTML="",y.appendChild(r),y.appendChild(u),document.querySelectorAll(".copyable").forEach(c=>{c.addEventListener("click",function(){const d=this.getAttribute("data-value");d&&navigator.clipboard.writeText(d).then(()=>{const s=document.createElement("div");s.className="copy-notification",s.textContent="Copied!",this.appendChild(s),setTimeout(()=>{s.remove()},1500)}).catch(s=>{console.error("Failed to copy:",s)})})}),E.scrollIntoView({behavior:"smooth"})}function N(e,t,n,h){let r="CLmax,"+t.join(" m/s,")+` m/s
`;n.forEach(u=>{const c=[u];t.forEach(d=>{const s=e.find(a=>a.clmax===u).vstalls.find(a=>a.vstall===d).wingArea;c.push(s?s.toFixed(4):"")}),r+=c.join(",")+`
`});const o=new Blob([r],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(o),l=document.createElement("a"),i=new Date().toISOString().replace(/[:.]/g,"-");l.setAttribute("href",m),l.setAttribute("download",`wing-area-results-${i}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}function A(e,t){t.addEventListener("click",()=>{document.fullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}),document.addEventListener("fullscreenchange",n),document.addEventListener("webkitfullscreenchange",n),document.addEventListener("mozfullscreenchange",n),document.addEventListener("MSFullscreenChange",n);function n(){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?(t.innerHTML=`
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"></path>
          </svg>
        `,t.title="Exit fullscreen"):(t.innerHTML=`
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
          </svg>
        `,t.title="Enter fullscreen")}}I&&I.addEventListener("click",()=>{addVstallRow(),x()}),F&&F.addEventListener("click",()=>{addClmaxRow(),x()}),v&&v.addEventListener("click",C),document.getElementById("reset")?.addEventListener("click",()=>{confirm("Are you sure you want to reset all inputs?")&&(localStorage.removeItem("wingAreaInputs"),location.reload())});function M(){b(),k(),L();const e=document.querySelector(".results-section"),t=document.getElementById("fullscreen-toggle");e&&t&&A(e,t)}M()});function w(g){const v=document.getElementById("debug-info");v&&(v.textContent=g,v.style.display="block"),console.error(g)}
